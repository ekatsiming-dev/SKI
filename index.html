<!DOCTYPE html>
<html lang="zh-Hant" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>野澤滑雪互動準備儀表板 | Nozawa Onsen Trip Planner</title>
    <!-- Chosen Palette: Winter Mountain -->
    <!-- Application Structure Plan: Inspired by the provided reference, the structure is a complete redesign into a modern, card-based, single-page application. The key change is the introduction of a more dynamic grid layout and dedicated sections for a clearer narrative flow, from high-level planning (Roadmap, Itinerary) to actionable details (Checklist, Budget). A new 'Itinerary' section was added to provide a chronological story of the trip. The most significant interactive enhancement is the dynamic budget calculator with a slider, allowing real-time 'what-if' analysis of personal spending. This structure was chosen to transform the tool from a static checklist into an engaging, visually-driven planning experience that encourages exploration and personalization. -->
    <!-- Visualization & Content Choices: 1. Countdown/Stats (Inform): Redesigned as prominent hero stats with icons. 2. Itinerary (Organize): A new visual timeline component using HTML/CSS to clearly show the day-by-day plan. 3. Interactive Checklist (Interact): UI refreshed with improved styling for buttons and items to match the new theme. 4. Dynamic Budget Calculator (Interact/Analyze): The static budget table is now interactive. A range slider allows users to adjust personal spending, which dynamically updates the total cost and the Chart.js doughnut chart via Vanilla JS. This provides immediate visual feedback on financial planning. Justification: These choices elevate the user experience by making information more digestible (icons, cards), providing a clearer trip narrative (itinerary), and adding powerful, personalized interactivity (budget calculator). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f9fafb; /* Light Gray */
            --card-bg: #ffffff;
            --text-primary: #1e293b; /* Slate 800 */
            --text-secondary: #475569; /* Slate 600 */
            --accent-primary: #3b82f6; /* Blue 500 */
            --accent-secondary: #14b8a6; /* Teal 500 */
            --border-color: #e5e7eb; /* Gray 200 */
        }
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
            color: var(--text-secondary);
        }
        .nav-link:hover, .nav-link.active {
            color: var(--accent-primary);
            transform: translateY(-2px);
        }
        .btn-filter {
            transition: all 0.2s ease-in-out;
        }
        .btn-filter.active {
            background-color: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }
        .glass-nav {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
        }
        .iti-item::before {
            content: '';
            position: absolute;
            left: -20.5px;
            top: 50%;
            transform: translateY(-50%);
            width: 15px;
            height: 15px;
            border-radius: 9999px;
            background-color: var(--accent-secondary);
            border: 3px solid var(--card-bg);
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--accent-primary);
            cursor: pointer;
            border-radius: 50%;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--accent-primary);
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto px-4 py-8 md:py-12">

        <header class="text-center mb-16">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-teal-400 pb-2">野澤溫泉滑雪之旅</h1>
            <p class="text-base sm:text-lg text-slate-600 mt-2">您的 2026/01/14 個人化互動準備儀表板</p>
        </header>

        <section id="overview" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-20 text-center">
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                <h3 class="text-lg font-semibold text-slate-500 flex items-center justify-center gap-2"><span>🗓️</span> 出發日期</h3>
                <p class="text-4xl font-bold text-blue-500 mt-2">2026/01/14</p>
            </div>
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                <h3 class="text-lg font-semibold text-slate-500 flex items-center justify-center gap-2"><span>⏳</span> 旅程倒數</h3>
                <p id="countdown" class="text-4xl font-bold text-blue-500 mt-2">計算中...</p>
            </div>
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                <h3 class="text-lg font-semibold text-slate-500 flex items-center justify-center gap-2"><span>🌙</span> 旅遊天數</h3>
                <p class="text-4xl font-bold text-blue-500 mt-2">5天4夜</p>
            </div>
        </section>

        <nav class="sticky top-4 glass-nav z-20 py-3 mb-20 rounded-full shadow-md border border-gray-200">
            <div class="flex flex-wrap justify-center items-center gap-x-4 sm:gap-x-6 md:gap-x-10 text-sm sm:text-base md:text-lg font-semibold">
                <a href="#itinerary" class="nav-link">行程總覽</a>
                <a href="#lodging" class="nav-link">住宿美食</a>
                <a href="#roadmap" class="nav-link">準備計畫</a>
                <a href="#checklist" class="nav-link">互動清單</a>
                <a href="#budget" class="nav-link">預算分析</a>
                <a href="#safety" class="nav-link">安全須知</a>
            </div>
        </nav>

        <main class="space-y-20">

            <section id="itinerary">
                <h2 class="text-3xl font-bold text-center mb-12">行程總覽</h2>
                <div class="max-w-3xl mx-auto relative border-l-2 border-dashed border-teal-300 pl-10">
                    <div class="iti-item relative mb-10 bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="absolute -left-10 top-1/2 -translate-y-1/2 bg-teal-500 text-white text-xs font-bold px-2 py-1 rounded-full">Day 1</p>
                        <h3 class="font-bold text-lg text-teal-600">移動與抵達</h3>
                        <p class="text-slate-500 text-sm">2026 / 01 / 14 (三)</p>
                        <ul class="list-disc list-inside mt-2 text-slate-600">
                            <li>搭乘 MM620 (02:20) 前往東京成田機場 (NRT)</li>
                            <li>轉乘新幹線 (13:30) 前往飯山站</li>
                            <li>抵達野澤溫泉，至 <span class="font-bold">Address Nozawa</span> Check-in</li>
                            <li>在溫泉街悠閒晚餐、熟悉環境</li>
                        </ul>
                    </div>
                    <div class="iti-item relative mb-10 bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="absolute -left-10 top-1/2 -translate-y-1/2 bg-teal-500 text-white text-xs font-bold px-2 py-1 rounded-full">Day 2</p>
                        <h3 class="font-bold text-lg text-teal-600">全日滑雪課程 & 道祖神祭</h3>
                        <p class="text-slate-500 text-sm">2026 / 01 / 15 (四)</p>
                        <ul class="list-disc list-inside mt-2 text-slate-600">
                            <li>全日6小時滑雪技巧學習</li>
                            <li>晚上參加日本三大火祭之一的「道祖神祭」</li>
                        </ul>
                    </div>
                     <div class="iti-item relative mb-10 bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="absolute -left-10 top-1/2 -translate-y-1/2 bg-teal-500 text-white text-xs font-bold px-2 py-1 rounded-full">Day 3</p>
                        <h3 class="font-bold text-lg text-teal-600">全日滑雪課程 & 溫泉體驗</h3>
                        <p class="text-slate-500 text-sm">2026 / 01 / 16 (五)</p>
                         <ul class="list-disc list-inside mt-2 text-slate-600">
                             <li>全日6小時滑雪技巧進階</li>
                             <li>課程結束後，享受野澤溫泉的13座外湯巡禮</li>
                         </ul>
                    </div>
                    <div class="iti-item relative mb-10 bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="absolute -left-10 top-1/2 -translate-y-1/2 bg-teal-500 text-white text-xs font-bold px-2 py-1 rounded-full">Day 4</p>
                        <h3 class="font-bold text-lg text-teal-600">自主練習 & 自由探索</h3>
                         <p class="text-slate-500 text-sm">2026 / 01 / 17 (六)</p>
                        <ul class="list-disc list-inside mt-2 text-slate-600">
                            <li>驗收學習成果，在初級雪道自主練習</li>
                            <li>探索野澤村，購買紀念品</li>
                        </ul>
                    </div>
                     <div class="iti-item relative bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="absolute -left-10 top-1/2 -translate-y-1/2 bg-teal-500 text-white text-xs font-bold px-2 py-1 rounded-full">Day 5</p>
                        <h3 class="font-bold text-lg text-teal-600">返程</h3>
                         <p class="text-slate-500 text-sm">2026 / 01 / 18 (日)</p>
                         <ul class="list-disc list-inside mt-2 text-slate-600">
                             <li>上午最後巡禮，整理行囊</li>
                             <li>搭乘 MM625 (16:35) 返回台灣桃園機場 (TPE)</li>
                         </ul>
                    </div>
                </div>
            </section>
            
            <section id="lodging">
                <h2 class="text-3xl font-bold text-center mb-12">住宿 & 美食推薦</h2>
                <div class="max-w-5xl mx-auto">
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200 mb-12">
                        <h3 class="font-bold text-xl text-blue-600 mb-3 flex items-center gap-2"><span>🏨</span> 下榻飯店</h3>
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
                            <p class="text-lg font-semibold">Address Nozawa (アドレス野沢)</p>
                            <a href="https://maps.app.goo.gl/jrp3bvtKam7p3Ukv7?g_st=il" target="_blank" class="mt-2 sm:mt-0 px-4 py-2 bg-blue-500 text-white text-sm font-semibold rounded-full hover:bg-blue-600 transition-colors">查看地圖</a>
                        </div>
                    </div>

                    <div>
                        <h3 class="font-bold text-xl text-blue-600 mb-6 flex items-center gap-2"><span>🍽️</span> 餐廳口袋名單</h3>
                        
                        <div class="mb-8">
                            <h4 class="font-semibold text-lg text-slate-700 border-b-2 border-teal-400 pb-2 mb-6">住宿附近</h4>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                                <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">焼肉 やま冨士</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">肉舖老闆開的燒肉店，便宜好吃但煙霧繚繞。</p>
                                    <a href="https://maps.app.goo.gl/Xema4Wy5LFK4bmQe8" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                                <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">お好み焼き 一ちゃん</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">住宿附近的大阪燒，有搭配部分小點心。</p>
                                    <a href="https://maps.app.goo.gl/dHJZGWeLGyB854178" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                            </div>
                        </div>

                        <div>
                             <h4 class="font-semibold text-lg text-slate-700 border-b-2 border-teal-400 pb-2 mb-6">溫泉街中心</h4>
                             <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                                <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">大門 (Daimon)</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">份量不錯的豬排飯、餃子，不接受預約。</p>
                                    <a href="https://maps.app.goo.gl/9auQUjGnYBL4dRXXA" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                                <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">ちゃんこ玉屋</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">不起眼的相撲鍋與壽喜燒火鍋店。</p>
                                    <a href="https://maps.app.goo.gl/MaDPYRLNsiBhJvw9A" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                                 <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">ばあどこ (Banri)</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">受外國人歡迎，店員會講中文，似乎有素火鍋。</p>
                                    <a href="https://maps.app.goo.gl/z8jz93uj8dTezBpQ8" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                                 <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">大まるそば店</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">蕎麥麵店，冬季似乎有熱湯選項。</p>
                                    <a href="https://maps.app.goo.gl/ZeLmRx18DeLYtofn6" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                                <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">三吉 (San-kichi)</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">關東煮，特色是有賣馬肉刺身。</p>
                                    <a href="https://maps.app.goo.gl/ZNtxotnGAbYGGa4o9" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                                <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">そば処 大茂ん</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">少數沒客滿的蕎麥麵店，可預約牛肉壽喜燒。</p>
                                    <a href="https://maps.app.goo.gl/i7GPzm396qtZyn62A" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                                 <div class="bg-white p-5 rounded-lg shadow border transition-transform hover:scale-105">
                                    <p class="font-bold">Playce Nozawa</p>
                                    <p class="text-sm text-slate-500 mt-1 mb-3">同時賣披薩、拉麵，晚上是居酒屋。</p>
                                    <a href="https://maps.app.goo.gl/Yp6cHT3zhVovRM7A9" target="_blank" class="text-sm font-semibold text-blue-500 hover:underline">查看地圖 →</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="roadmap">
                <h2 class="text-3xl font-bold text-center mb-12">準備時程計畫</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-xl font-bold text-blue-600 mb-3">第一階段：核心準備</h3>
                        <p class="font-semibold text-slate-500 text-sm mb-4">現在 ~ 2025/10月底</p>
                        <ul class="space-y-2 text-slate-600">
                            <li>🔴 <span class="font-medium">換發護照：</span>最優先！</li>
                            <li>🔴 <span class="font-medium">預訂機票 & 住宿</span> <a href="https://www.flypeach.com/tw" target="_blank" class="text-blue-500 hover:underline text-sm">[樂桃]</a></li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-xl font-bold text-blue-600 mb-3">第二階段：細節規劃</h3>
                        <p class="font-semibold text-slate-500 text-sm mb-4">2025/11 ~ 12月</p>
                        <ul class="space-y-2 text-slate-600">
                            <li>🟡 <span class="font-medium">申請休假</span></li>
                            <li>🟡 <span class="font-medium">採購個人裝備</span></li>
                            <li>🟡 <span class="font-medium">購買網卡/保險</span> <a href="https://www.klook.com/zh-TW/activity/109393-japan-esim-high-speed-internet-qr-code-voucher/" target="_blank" class="text-blue-500 hover:underline text-sm">[eSIM參考]</a></li>
                            <li>🟡 <span class="font-medium">預訂高鐵/兌換日幣</span></li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-xl font-bold text-blue-600 mb-3">第三階段：最終衝刺</h3>
                        <p class="font-semibold text-slate-500 text-sm mb-4">2026/1月</p>
                        <ul class="space-y-2 text-slate-600">
                            <li>🔵 <span class="font-medium">填寫 Visit Japan Web</span></li>
                            <li>🔵 <span class="font-medium">打包行李</span></li>
                            <li>🔵 <span class="font-medium">最終確認與休息</span></li>
                        </ul>
                    </div>
                </div>
            </section>
            
            <section id="checklist">
                <h2 class="text-3xl font-bold text-center mb-4">互動式準備清單</h2>
                <p class="text-center text-slate-600 mb-8 max-w-2xl mx-auto">清單已根據最新的服裝策略更新。點擊按鈕篩選，勾選以追蹤進度。</p>
                <div id="checklist-filters" class="flex flex-wrap justify-center gap-2 mb-8">
                </div>
                <div id="checklist-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                </div>
            </section>
            
            <section id="budget">
                <h2 class="text-3xl font-bold text-center mb-12">互動式預算分析</h2>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-3 bg-white rounded-2xl shadow-lg p-6 md:p-8 border border-gray-200">
                        <h3 class="text-2xl font-bold mb-6 text-center">費用細項 & 計算機</h3>
                        <table class="w-full text-left mb-6">
                           <thead class="border-b-2 border-gray-200">
                                <tr><th class="py-2">項目</th><th class="py-2 text-right">費用 (TWD)</th></tr>
                           </thead>
                           <tbody id="budget-table-body">
                           </tbody>
                        </table>
                        <div class="mt-6">
                            <label for="personal-spending" class="block font-medium text-slate-600 mb-2">調整個人花費 (購物、紀念品...)</label>
                            <input type="range" id="personal-spending" min="0" max="20000" step="1000" value="5000" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <div class="flex justify-between text-sm text-slate-500 mt-1">
                                <span>TWD 0</span>
                                <span id="personal-spending-value" class="font-bold text-blue-500">TWD 5,000</span>
                                <span>TWD 20,000</span>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-2 bg-white rounded-2xl shadow-lg p-6 border border-gray-200 flex flex-col justify-between">
                         <div>
                            <h3 class="text-2xl font-bold mb-4 text-center">預估費用佔比</h3>
                            <div class="chart-container">
                                <canvas id="budgetChart"></canvas>
                            </div>
                         </div>
                         <div class="text-center mt-6">
                             <p class="text-slate-500">預估總計 (不含個人花費)</p>
                             <p id="subtotal-cost" class="text-3xl font-bold"></p>
                             <p class="text-slate-600 mt-4">最終總計 (含個人花費)</p>
                             <p id="total-cost" class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-teal-400"></p>
                         </div>
                    </div>
                </div>
            </section>

            <section id="safety">
                <h2 class="text-3xl font-bold text-center mb-12">滑雪安全須知</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-5xl mx-auto">
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="font-bold text-lg mb-2">① 正確跌倒，保護自己</p>
                        <p class="text-slate-600">感覺快要失控時，主動向後方或側後方坐倒。**核心技巧是「用屁股著地」**，絕對不要用手腕去撐地，非常容易造成手腕骨折。</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="font-bold text-lg mb-2">② 選擇適合自己的雪道</p>
                        <p class="text-slate-600">雪場會用顏色標示雪道難度（綠線：初級）。請務必在教練指導下，從綠線開始，**不要輕易挑戰超出自己能力的雪道**。</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="font-bold text-lg mb-2">③ 隨時注意周遭環境</p>
                        <p class="text-slate-600">在雪道上休息或停留時，請務必停在**雪道的兩側**，避免停在雪道中間或轉彎處的死角，以免被後方滑行者撞上。</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <p class="font-bold text-lg mb-2">④ 安全裝備不可少</p>
                        <p class="text-slate-600">**安全帽是必備品**，能有效保護頭部。雪鏡和護具（如防摔褲、護膝）也能大幅增加安全性。</p>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="text-center mt-20 pt-8 border-t border-gray-200">
            <p class="text-slate-500">祝您有趟愉快又安全的滑雪之旅！</p>
            <p class="text-sm text-slate-400 mt-1">互動儀表板 by Gemini</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const checklistData = [
                { name: '運動排汗衣褲', category: 'buy', description: '準備2套，絕對避免棉質！選擇聚酯纖維或羊毛材質。' },
                { name: '刷毛中層衣', category: 'buy', description: '1-2件，作為保暖中層。' },
                { name: '中高筒雪襪', category: 'buy', description: '準備5雙，羊毛或機能材質，保護腳踝。' },
                { name: '面罩/脖圍', category: 'buy', description: '防風、防曬、保護臉部。' },
                { name: '拋棄式內褲', category: 'buy', description: '方便旅行使用，依天數準備。' },
                { name: '防水防風雪衣', category: 'rent', description: '外層衣物，新手建議租用即可。' },
                { name: '防水防風雪褲', category: 'rent', description: '外層衣物，新手建議租用即可。' },
                { name: '雪板/雙板雪杖', category: 'rent', description: '在野澤當地雪具店租用，方便且專業。' },
                { name: '雪鞋 (Boots)', category: 'rent', description: '尺寸合腳最重要，由專業店家協助挑選。' },
                { name: '安全帽 (Helmet)', category: 'rent', description: '安全第一！強烈建議租用。' },
                { name: '雪鏡 (Goggles)', category: 'rent', description: '防霧、防紫外線，應對不同天氣。' },
                { name: '防水滑雪手套', category: 'rent', description: '保護雙手溫暖乾燥。' },
                { name: '防摔褲', category: 'rent', description: '新手強力推薦！保護臀部與尾椎。' },
                { name: '護膝', category: 'rent', description: '增加對膝蓋的保護。' },
                { name: '護照/身分證', category: 'pack', description: '最重要的身分證明文件。' },
                { name: '日幣現金/信用卡', category: 'pack', description: '準備足夠的現金以備不時之需。' },
                { name: '個人藥品', category: 'pack', description: '感冒藥、腸胃藥、止痛藥、痠痛貼布等。' },
                { name: '生理用品', category: 'pack', description: '若遇生理期，請預先準備相關用品。' },
                { name: '維持器', category: 'pack', description: '個人牙齒維持器。' },
                { name: '防曬乳/護唇膏', category: 'pack', description: '雪地紫外線強烈，空氣乾燥。' },
                { name: '手機/充電器', category: 'pack', description: '包含行動電源，保持通訊暢通。' },
                { name: '日本上網卡/WiFi', category: 'pack', description: '預先購買或租用，確保網路連線。' },
                { name: '防水雪靴', category: 'pack', description: '非滑雪時在雪地行走穿著。' },
                { name: '日常便服', category: 'pack', description: '準備2套，在旅館或非滑雪時穿著。' },
                { name: '泳衣', category: 'pack', description: '野澤是溫泉鄉，別忘了泡溫泉！' }
            ];

            let budgetChart;
            const budgetItems = [
                { label: '✈️ 機票來回', cost: 16000, note: '已預訂' },
                { label: '🏂 教練課', cost: 12667, note: '6人分攤 / 2天' },
                { label: '🏨 住宿', cost: 15000, note: '估計值 (4晚)' },
                { label: '🍜 餐飲雜支', cost: 10000, note: '估計值' },
                { label: '🎟️ 雪票', cost: 5000, note: '估計值 (4天)' },
                { label: '🎿 雪具租賃', cost: 3500, note: '估計值 (4天)' },
                { label: '🚄 交通', cost: 4200, note: '高鐵/新幹線/巴士' }
            ];

            const startCountdown = () => {
                const targetDate = new Date('2026-01-14T00:00:00').getTime();
                const countdownEl = document.getElementById('countdown');
                const interval = setInterval(() => {
                    const now = new Date().getTime();
                    const distance = targetDate - now;
                    if (distance < 0) {
                        clearInterval(interval);
                        countdownEl.innerHTML = "出發！";
                        return;
                    }
                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    countdownEl.innerHTML = `${days} 天`;
                }, 1000);
            };

            const setupChecklist = () => {
                const filtersContainer = document.getElementById('checklist-filters');
                const checklistContainer = document.getElementById('checklist-container');
                const categories = { 'all': '全部項目', 'buy': '自行採購', 'rent': '當地租賃', 'pack': '打包用品' };

                const renderChecklist = (filter = 'all') => {
                    checklistContainer.innerHTML = '';
                    const filteredData = filter === 'all' ? checklistData : checklistData.filter(item => item.category === filter);
                    
                    filteredData.forEach(item => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'bg-white p-4 rounded-lg shadow border border-gray-200 flex items-center space-x-3 cursor-pointer hover:shadow-md transition-shadow group relative';
                        itemEl.innerHTML = `
                            <input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <label class="font-medium text-slate-700">${item.name}</label>
                            <div class="absolute bottom-full mb-2 w-max max-w-xs left-1/2 -translate-x-1/2 bg-slate-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10">
                                ${item.description}
                                <svg class="absolute text-slate-800 h-2 w-full left-0 top-full" x="0px" y="0px" viewBox="0 0 255 255" xml:space="preserve"><polygon class="fill-current" points="0,0 127.5,127.5 255,0"/></svg>
                            </div>
                        `;
                        checklistContainer.appendChild(itemEl);
                    });
                };

                Object.keys(categories).forEach(key => {
                    const button = document.createElement('button');
                    button.textContent = categories[key];
                    button.dataset.filter = key;
                    button.className = 'btn-filter px-4 py-2 rounded-full font-semibold text-sm transition bg-white border border-gray-300 hover:bg-gray-100';
                    if (key === 'all') button.classList.add('active');
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.btn-filter').forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        renderChecklist(key);
                    });
                    filtersContainer.appendChild(button);
                });

                renderChecklist();
            };

            const setupBudgetCalculator = () => {
                const spendingSlider = document.getElementById('personal-spending');
                const spendingValueEl = document.getElementById('personal-spending-value');
                const subtotalEl = document.getElementById('subtotal-cost');
                const totalEl = document.getElementById('total-cost');
                const tableBody = document.getElementById('budget-table-body');
                
                const formatCurrency = (num) => `TWD ${num.toLocaleString()}`;

                const renderTable = () => {
                    tableBody.innerHTML = '';
                    budgetItems.forEach(item => {
                        const row = `
                            <tr class="border-b border-gray-200">
                                <td class="py-3 pr-2">${item.label}</td>
                                <td class="py-3 text-right font-semibold">${item.cost.toLocaleString()}</td>
                            </tr>`;
                        tableBody.innerHTML += row;
                    });
                };
                
                const updateChart = (personalSpending) => {
                    const subtotal = budgetItems.reduce((sum, item) => sum + item.cost, 0);
                    const total = subtotal + personalSpending;
                    
                    const chartData = budgetItems.map(item => item.cost);
                    const chartLabels = budgetItems.map(item => item.label.split(' ')[1]);

                    if (personalSpending > 0) {
                        chartData.push(personalSpending);
                        chartLabels.push('個人花費');
                    }

                    if (budgetChart) {
                        budgetChart.data.labels = chartLabels;
                        budgetChart.data.datasets[0].data = chartData;
                        budgetChart.update();
                    } else {
                        const ctx = document.getElementById('budgetChart').getContext('2d');
                        budgetChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: chartLabels,
                                datasets: [{
                                    data: chartData,
                                    backgroundColor: ['#3b82f6', '#14b8a6', '#f59e0b', '#ef4444', '#8b5cf6', '#6366f1', '#ec4899'],
                                    borderColor: '#ffffff',
                                    borderWidth: 4,
                                    hoverOffset: 8
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                cutout: '70%'
                            }
                        });
                    }
                    
                    subtotalEl.textContent = formatCurrency(subtotal);
                    totalEl.textContent = formatCurrency(total);
                };

                spendingSlider.addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    spendingValueEl.textContent = formatCurrency(value);
                    updateChart(value);
                });
                
                renderTable();
                updateChart(parseInt(spendingSlider.value));
            };
            
            startCountdown();
            setupChecklist();
            setupBudgetCalculator();
        });
    </script>
</body>
</html>

